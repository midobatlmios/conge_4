import{j as e,r,K as D,L as R,S as j}from"./app-Ce2YBpep.js";import{D as M,a as N,b as _,c as F,A as V}from"./app-layout-Df8PrIGE.js";import{C as b}from"./checkbox-CJqiaP_X.js";import{B as i}from"./createLucideIcon-n0k5XbGK.js";import{A as k,E as P}from"./EditDemandeModal-Cytckdey.js";import{u as T,f as y,g as A,a as K,b as I,c as E}from"./index-D3rSU_rS.js";import{I as L}from"./input-CLdAzZZD.js";import{T as O,a as z,b as C,c as U,d as H,e as S}from"./select-WDzcoPeP.js";import"./check-464ca9Dm.js";import"./index-I4XksjuF.js";import"./index-CvAtKPGS.js";const B=(d,c,o,m)=>[{id:"select",header:({table:s})=>e.jsx(b,{checked:s.getIsAllPageRowsSelected()||s.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:t=>s.toggleAllPageRowsSelected(!!t),"aria-label":"Select all"}),cell:({row:s})=>e.jsx(b,{checked:s.getIsSelected(),onCheckedChange:t=>s.toggleSelected(!!t),"aria-label":"Select row"})},{accessorKey:"user.name",header:"Employé"},{id:"remaining_days",header:"Jours restants",cell:({row:s})=>{const t=s.original.user.remaining_days??18;return e.jsxs("div",{className:`font-medium ${t<=5?"text-red-500":t<=10?"text-yellow-500":"text-green-500"}`,children:[t," jours"]})}},{accessorKey:"date_demande",header:"Date de demande",cell:({row:s})=>new Date(s.getValue("date_demande")).toLocaleDateString("fr-FR")},{accessorKey:"date_debut",header:"Date de début",cell:({row:s})=>new Date(s.getValue("date_debut")).toLocaleDateString("fr-FR")},{accessorKey:"date_fin",header:"Date de fin",cell:({row:s})=>new Date(s.getValue("date_fin")).toLocaleDateString("fr-FR")},{accessorKey:"type_conge",header:"Type de congé",cell:({row:s})=>{const t=s.getValue("type_conge");return e.jsxs("div",{className:"font-medium",children:[t==="mariage"&&"Congé de Mariage",t==="naissance"&&"Congé de Naissance",t==="deces"&&"Congé de Décès",t==="sans_solde"&&"Congé sans solde",t==="recuperation"&&"Récupération"]})}},{accessorKey:"nbr_jours",header:"Nombre de jours",cell:({row:s})=>{const t=parseFloat(s.getValue("nbr_jours"));return e.jsxs("div",{className:"text-right font-medium",children:[t," jour",t!==1?"s":""]})}},{accessorKey:"etat",header:"État",cell:({row:s})=>{const t=s.getValue("etat");return e.jsx("div",{className:`font-medium ${t==="en attente"?"text-yellow-500":t==="acceptée"?"text-green-500":"text-red-500"}`,children:t})}},{accessorKey:"annee",header:"Année"},{accessorKey:"comment",header:"Commentaire",cell:({row:s})=>{const t=s.original.comment;return e.jsx("div",{className:"max-w-xs truncate",title:t||"",children:t||"-"})}},{id:"actions",cell:({row:s})=>{const t=s.original,u=!m&&["mariage","naissance","deces"].includes(t.type_conge);return e.jsxs("div",{className:"flex gap-2",children:[!u&&e.jsx(i,{variant:"outline",size:"sm",className:"text-yellow-600 hover:text-yellow-700 hover:bg-yellow-50",onClick:()=>{o(t),c(!0)},children:"Modifier"}),e.jsx(i,{variant:"outline",size:"sm",className:"text-red-600 hover:text-red-700 hover:bg-red-50",onClick:()=>d(t.id),children:"Supprimer"})]})}}];function $({columns:d,data:c}){var f,w;const[o,m]=r.useState([]),[s,t]=r.useState([]),[u,g]=r.useState({}),[x,h]=r.useState(!1),[p,v]=r.useState({}),l=T({data:c,columns:d,getCoreRowModel:E(),getPaginationRowModel:I(),onSortingChange:m,getSortedRowModel:K(),onColumnFiltersChange:t,getFilteredRowModel:A(),onColumnVisibilityChange:v,onRowSelectionChange:g,state:{sorting:o,columnFilters:s,columnVisibility:p,rowSelection:u}});return e.jsxs("div",{children:[e.jsxs("div",{className:"flex-1 text-sm text-muted-foreground",children:[l.getFilteredSelectedRowModel().rows.length," of"," ",l.getFilteredRowModel().rows.length," row(s) selected."]}),e.jsxs("div",{className:"flex items-center py-4",children:[e.jsx(L,{placeholder:"Filter etat",value:((f=l.getColumn("etat"))==null?void 0:f.getFilterValue())??"",onChange:a=>{var n;return(n=l.getColumn("etat"))==null?void 0:n.setFilterValue(a.target.value)},className:"max-w-sm"}),e.jsx(i,{variant:"outline",className:"ml-2",onClick:()=>h(!0),children:"Add"}),e.jsxs(M,{children:[e.jsx(N,{asChild:!0,children:e.jsx(i,{variant:"outline",className:"ml-auto",children:"Columns"})}),e.jsx(_,{align:"end",children:l.getAllColumns().filter(a=>a.getCanHide()).map(a=>e.jsx(F,{className:"capitalize",checked:a.getIsVisible(),onCheckedChange:n=>a.toggleVisibility(!!n),children:a.id},a.id))})]})]}),e.jsxs("div",{className:"rounded-md border",children:[e.jsxs(O,{children:[e.jsx(z,{children:l.getHeaderGroups().map(a=>e.jsx(C,{children:a.headers.map(n=>e.jsx(U,{children:n.isPlaceholder?null:y(n.column.columnDef.header,n.getContext())},n.id))},a.id))}),e.jsx(H,{children:(w=l.getRowModel().rows)!=null&&w.length?l.getRowModel().rows.map(a=>e.jsx(C,{"data-state":a.getIsSelected()&&"selected",children:a.getVisibleCells().map(n=>e.jsx(S,{children:y(n.column.columnDef.cell,n.getContext())},n.id))},a.id)):e.jsx(C,{children:e.jsx(S,{colSpan:d.length,className:"h-24 text-center",children:"No results."})})})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-2 py-4",children:[e.jsx(i,{variant:"outline",size:"sm",onClick:()=>l.previousPage(),disabled:!l.getCanPreviousPage(),children:"Previous"}),e.jsx(i,{variant:"outline",size:"sm",onClick:()=>l.nextPage(),disabled:!l.getCanNextPage(),children:"Next"}),e.jsx(k,{isOpen:x,onClose:()=>h(!1)}),"      "]})]})]})}const J=[{title:"Demandes",href:"/demandes"}];function ne({demandes:d}){const[c,o]=r.useState(!1),[m,s]=r.useState(null),{auth:t}=D().props,g=t.user.role==="admin",x=()=>{o(!1),j.reload({preserveUrl:!0})},h=p=>{window.confirm("Êtes-vous sûr de vouloir supprimer cette demande ?")&&j.delete(`/demandes/${p}`,{preserveUrl:!0,onSuccess:()=>{j.reload({preserveUrl:!0})}})};return e.jsxs(V,{breadcrumbs:J,children:[e.jsx(R,{title:"Demandes"}),e.jsx("div",{className:"container mx-auto py-10",children:e.jsx($,{columns:B(h,o,s,g),data:d})}),e.jsx(P,{isOpen:c,onClose:()=>o(!1),demande:m,onUpdate:x,isAdmin:g})]})}export{ne as default};
